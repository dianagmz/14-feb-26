<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para mi guapo ‚ù§Ô∏è</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@400;600&display=swap');

        :root {
            --color-fondo: #ffe5ec;
            --color-sobre: #fb6f92;
            --color-tapa: #ff8fab;
            --color-carta: #ffffff;
            --color-texto: #5c5c5c;
            --color-titulo: #e63946;
        }

        body {
            margin: 0; padding: 0;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; background-color: var(--color-fondo);
            font-family: 'Quicksand', sans-serif; overflow: hidden;
        }

        /* Contenedor del sobre */
        .envelope-wrapper {
            position: relative;
            width: 320px; height: 220px;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .envelope {
            position: relative; width: 100%; height: 100%;
            background-color: var(--color-sobre);
            border-radius: 0 0 15px 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            z-index: 1;
        }

        .flap {
            position: absolute; top: 0; left: 0;
            border-left: 160px solid transparent;
            border-right: 160px solid transparent;
            border-top: 120px solid var(--color-tapa);
            transform-origin: top; transition: transform 0.6s ease;
            z-index: 4;
        }

        .front {
            position: absolute; top: 0; left: 0;
            width: 0; height: 0;
            border-left: 160px solid transparent;
            border-right: 160px solid transparent;
            border-bottom: 110px solid var(--color-sobre);
            z-index: 3;
        }

        /* La Carta (con scroll interno) */
        .card {
            position: absolute; top: 5px; left: 10px;
            width: 300px; height: 190px;
            background-color: var(--color-carta);
            border-radius: 10px; z-index: 2;
            opacity: 0;
            transition: transform 0.8s ease, opacity 0.4s ease, height 0.8s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            overflow-y: auto; scroll-behavior: smooth;
        }

        /* Paso 1: Foto tipo Polaroid */
        .photo-step {
            display: flex; flex-direction: column; align-items: center;
            padding: 20px;
        }

        .polaroid {
            width: 90%; background: white;
            padding: 10px 10px 30px 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transform: rotate(-2deg); margin-bottom: 20px;
        }

        .polaroid img { width: 100%; height: auto; display: block; }

        /* Paso 2: El mensaje (oculto al inicio) */
        .message-step {
            padding: 0 20px 20px 20px;
            text-align: center;
            display: none; /* Se activa con JS */
        }

        .card h2 {
            font-family: 'Dancing Script', cursive;
            color: var(--color-titulo); font-size: 1.6rem; margin: 10px 0;
        }

        .card p { font-size: 14px; line-height: 1.6; color: var(--color-texto); }

        /* Bot√≥n interactivo dentro de la carta */
        .btn-leer {
            background: var(--color-titulo); color: white;
            border: none; padding: 10px 20px; border-radius: 20px;
            font-weight: bold; cursor: pointer; margin-top: 10px;
            font-family: 'Quicksand', sans-serif;
            transition: transform 0.2s;
        }

        .btn-leer:active { transform: scale(0.95); }

        /* Animaciones de apertura */
        .open .flap { transform: rotateX(180deg); z-index: 1; }
        .open .card {
            opacity: 1; transform: translateY(-180px);
            height: 400px; z-index: 5;
        }

        .heart-btn {
            position: absolute; top: 50%; left: 50%;
            width: 50px; height: 50px; background-color: var(--color-titulo);
            transform: translate(-50%, -20%) rotate(45deg);
            z-index: 6; transition: opacity 0.5s ease;
        }
        .heart-btn::before, .heart-btn::after {
            content: ""; position: absolute; width: 50px; height: 50px;
            background-color: var(--color-titulo); border-radius: 50%;
        }
        .heart-btn::before { left: -25px; }
        .heart-btn::after { top: -25px; }

        .open .heart-btn { opacity: 0; pointer-events: none; }

        .instruction {
            position: absolute; bottom: -60px; width: 100%;
            text-align: center; color: var(--color-titulo); font-weight: 600;
        }

        /* Estilo del scrollbar */
        .card::-webkit-scrollbar { width: 4px; }
        .card::-webkit-scrollbar-thumb { background: var(--color-tapa); border-radius: 10px; }
    </style>
</head>
<body>

    <div class="envelope-wrapper" id="envelope">
        <div class="flap"></div>
        <div class="front"></div>
        <div class="envelope"></div>
        <div class="heart-btn"></div>
        
        <div class="card" id="mainCard">
            <div class="photo-step" id="photoStep">
                <div class="polaroid">
                    <img src="image/mifoto.jpeg" alt="Nosotros">
                </div>
                <button class="btn-leer" onclick="mostrarMensaje(event)">Click para leer mi carta ‚ù§Ô∏è</button>
            </div>

            <div class="message-step" id="messageStep">
                <h2>¬°Feliz San Valent√≠n, Lindo! ‚ù§Ô∏è</h2>
                <p>Te amo mucho, gracias por cuidarme y escucharme siempre. Estoy super agradecida de haber compartido m√°s de un a√±o a tu lado.</p>
                <p>Espero compartir muchoooooo tiempo m√°s juntos, riendonos, jugando, paseando y comiendo ricoo.</p>
                <p style="font-weight: bold; color: var(--color-titulo); margin-top: 15px;">
                    Eres el novio m√°s guapo y perfecto del mundooo y yo un poco renegona ya s√© pero soportaaa... por que no te vas a ir. muak besitos. üíã
                </p>
            </div>
        </div>

        <div class="instruction">Haz click para abrir ‚ù§Ô∏è</div>
    </div>

    <script>
        const envelope = document.getElementById('envelope');
        const card = document.getElementById('mainCard');
        const photoStep = document.getElementById('photoStep');
        const messageStep = document.getElementById('messageStep');

        // Abrir el sobre
        envelope.addEventListener('click', function() {
            if(!this.classList.contains('open')) {
                this.classList.add('open');
            }
        });

        // Funci√≥n para mostrar el mensaje y lanzar serpentinas
        function mostrarMensaje(event) {
            event.stopPropagation(); // Evita que el sobre se cierre al hacer click en el bot√≥n
            
            messageStep.style.display = 'block';
            
            // Scroll suave hacia el mensaje
            card.scrollTo({
                top: card.scrollHeight,
                behavior: 'smooth'
            });

            // EFECTO DE SERPENTINAS Y FUEGOS ARTIFICIALES
            var duration = 5 * 1000;
            var animationEnd = Date.now() + duration;
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            function randomInRange(min, max) {
              return Math.random() * (max - min) + min;
            }

            var interval = setInterval(function() {
              var timeLeft = animationEnd - Date.now();

              if (timeLeft <= 0) {
                return clearInterval(interval);
              }

              var particleCount = 50 * (timeLeft / duration);
              // Lanza desde dos puntos diferentes
              confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
              confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);
        }
    </script>
</body>
</html>
